---
import { swapLang, withBase, type Lang } from "../lib/site";

const { lang = "el" } = Astro.props as { lang?: Lang };
const pathname = Astro.url.pathname;

const t = (elText: string, enText: string) => (lang === "en" ? enText : elText);

const base = lang === "en" ? "/en" : "/el";
const nav = [
  { href: withBase(`${base}/`), label: t("Αρχική", "Home") },
  { href: withBase(`${base}/about`), label: t("Σχετικά", "About") },
  { href: withBase(`${base}/projects`), label: t("Projects", "Projects") },
  { href: withBase(`${base}/contact`), label: t("Επικοινωνία", "Contact") }
];

const home = withBase(`${base}/`);
const otherLangPath = swapLang(pathname);
const otherLangLabel = lang === "en" ? "Ελληνικά" : "English";

const isActive = (href: string) => pathname === href || (href.endsWith("/") && pathname === href);
---

<header id="top" class="sticky top-0 z-40 border-b border-white/10 bg-slate-950/45 backdrop-blur-xl">
  <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-4 sm:px-6 lg:px-8">
    <a href={home} class="inline-flex items-center gap-3">
      
      <img
        src={withBase("/favicon.png")}
        alt=""
        width="80"
        height="80"
        class="h-15 w-15 opacity-95"
        loading="eager"
        decoding="async"
      />

      <span class="text-sm font-semibold tracking-tight text-white/90 hover:text-white">
        {t("Λουκάς Θέος", "Loukas Theos")}
      </span>
    </a>

    <nav class="hidden items-center gap-6 md:flex" aria-label="Primary">
      {nav.map((item) => (
        <a
          href={item.href}
          class={"text-sm transition-colors " + (isActive(item.href) ? "text-white" : "text-white/70 hover:text-white")}
          aria-current={isActive(item.href) ? "page" : undefined}
        >
          {item.label}
        </a>
      ))}

      <a class="btn-ghost" href={otherLangPath}>{otherLangLabel}</a>
    </nav>

    <details class="md:hidden">
      <summary class="btn-ghost cursor-pointer list-none">{t("Μενού", "Menu")}</summary>
      <div class="mt-3 w-[260px] rounded-2xl border border-white/10 bg-slate-950/80 p-3 backdrop-blur">
        <div class="flex flex-col gap-2">
          {nav.map((item) => (
            <a
              href={item.href}
              class={"rounded-xl px-3 py-2 text-sm " + (isActive(item.href) ? "bg-white/10 text-white" : "text-white/80 hover:bg-white/5")}
            >
              {item.label}
            </a>
          ))}
          <a class="rounded-xl px-3 py-2 text-sm text-white/80 hover:bg-white/5" href={otherLangPath}>
            {otherLangLabel}
          </a>
        </div>
      </div>
    </details>
  </div>
</header>
